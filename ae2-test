-- Crafting-Aufträge auf Monitor anzeigen (Advanced Peripherals + ME Bridge)

-- Peripherie automatisch finden
local bridge = peripheral.find("me_bridge")
if not bridge then
    print("No ME Bridge found.")
    return
end

local monitor = peripheral.find("monitor")
if not monitor then
    print("No monitor found.")
    return
end

-- Monitor vorbereiten
if monitor.setTextScale then
    monitor.setTextScale(1)  -- optional, nur wenn unterstützt
end
monitor.clear()

-- Funktion: Crafting-Aufträge abrufen und anzeigen
local function showCraftingTasks()
    monitor.clear()
    local tasks = bridge.getCraftingTasks()  -- Alle Crafting-Aufträge abrufen

    if #tasks == 0 then
        monitor.setCursorPos(1,1)
        monitor.write("Keine Crafting-Aufträge aktiv.")
        return
    end

    monitor.setCursorPos(1,1)
    monitor.write("Aktuelle Crafting-Aufträge:")

    for i, task in ipairs(tasks) do
        local label = task.label or task.id or "Unbekannt"
        local progress = math.floor((task.progress or 0) * 100)
        monitor.setCursorPos(1, i+1)
        monitor.write(i .. ". " .. label .. " | Fortschritt: " .. progress .. "%")
    end
end

-- Hauptschleife: alle 5 Sekunden aktualisieren
while true do
    showCraftingTasks()
    sleep(5)
end
